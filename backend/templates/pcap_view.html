{% extends "base.html" %}{% block content %}
<h2 class="text-xl font-semibold mb-3">View: {{ file }}</h2>

<div class="bg-white p-4 rounded-2xl shadow space-y-3">
  <div class="flex flex-wrap items-center gap-2">
    <form hx-get="/pcaps/view_table"
          hx-target="#table"
          class="flex flex-wrap items-center gap-2">
      <input type="hidden" name="dir"  value="{{ dir }}"/>
      <input type="hidden" name="file" value="{{ file }}"/>
      <input class="border rounded px-2 py-1" name="dfilter" placeholder="display filter (ex: tcp.port==80)"/>
      <input class="border rounded px-2 py-1 w-24" name="count"   value="100" />
      <button class="px-3 py-1 bg-slate-800 text-white rounded">Apply</button>
    </form>

    <a class="px-3 py-1 bg-slate-100 rounded border"
       href="/pcaps/download?dir={{ dir }}&file={{ file }}">Download</a>
  </div>

  <div class="text-xs text-slate-600">
    Tip: “display filter”는 Wireshark와 동일 문법. (예: `ip`, `tcp.port==80`, `http`)
  </div>

  <div id="table" hx-get="/pcaps/view_table?dir={{ dir }}&file={{ file }}&count=100"
       hx-trigger="load" class="overflow-auto"></div>

  <details class="text-sm">
    <summary class="cursor-pointer">Open in Wireshark (수동)</summary>
    <div class="mt-2">
      <div>서버에서 로컬로 복사 후 열기 예시:</div>
      <pre class="bg-slate-50 p-2 rounded border whitespace-pre-wrap">
scp {{ abs_path }} .
wireshark {{ file }}</pre>
    </div>
  </details>
</div>
{% endblock %}

